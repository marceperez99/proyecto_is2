{% extends 'base.html' %}
{% block title %}{{ item }}{% endblock %}
{% block content %}
    {% include 'navBar.html' %}
    {% include 'breadcrumb.html' %}
    <div class="container mt-3">

        <div class="row">

            <h3 class="col-4">Item de Proyecto</h3>
            <div class="col-8 text-right">
                <!-- TODO faltan ponerle las restricciones a estos botones segun permisos y estados -->
                {% if item.estado == 'No Aprobado' %}
                    <a href="{% url 'solicitar_aprobacion_item' proyecto.id fase.id item.id %}" class="btn btn-success  border-0">Solicitar Aprobación de Item</a>

                {% elif item.estado == 'Listo para su aprobación' %}
                    <a href="{% url 'aprobar_item' proyecto.id fase.id item.id %}" class="btn btn-success  border-0">Aprobar Item</a>
                    <a href="#" class="btn btn-danger bg-color-danger border-0">Cancelar Aprobación</a>
                {% endif %}

                {% if item.estado == 'No Aprobado' %}
                    <a href="#" class="btn btn-primary bg-color-accent border-0">Modificar Item</a>
                {% endif %}
                {% if item.estado == 'Aprobado' %}
                    <a href="#" class="btn btn-danger bg-color-danger border-0">Desaprobar Item</a>
                {% endif %}
                {% if se_puede_eliminar %}
                <a href="{% url 'eliminar_item' proyecto.id fase.id item.id %}" class="btn btn-danger bg-color-danger border-0">Eliminar Item</a>
                {% endif %}
            </div>
            <hr class="col-12">

            <div class="col-10 bg-white border rounded p-3 mx-auto">
                <div class="row">
                    <div class="col-4 h5 my-3">Codigo</div><div class="col-8 my-3">{{ item.codigo }}</div>
                    <div class="col-4 h5 my-3">Nombre</div><div class="col-8 my-3">{{ item.version.nombre }}</div>
                    <div class="col-4 h5 my-3">Descripcion</div><div class="col-8 my-3">{{ item.version.descripcion }}</div>
                    <div class="col-4 h5 my-3">Estado</div><div class="col-8 my-3">{{ item.estado }}</div>
                    <div class="col-4 h5 my-3">Version</div>
                    <div class="col-8 my-3">{{ item.version.version }}</div>
                    {% for atr in item.get_atributos_dinamicos %}
                    <div class="col-4 h5 my-3">{{atr.plantilla.nombre}}</div>
                        <div class="col-8 my-3">
                            {% if atr.valor == None %}

                                {% elif atr.valor == True %}
                                    Si
                                 {% elif atr.valor == False %}
                                    No
                                {% else %}
                                    {{atr.valor}}
                            {% endif %}
                        </div>
                    {% endfor %}
                    <hr class="col-10">
                    <div class="col-auto ml-auto"><a href="{% url 'historial_item' proyecto.id fase.id item.id %}" class="btn ml-auto btn-primary bg-color-accent">Visualizar Historial de Cambios</a></div>

                </div>
            </div>
        </div>
    </div>
{% endblock %}